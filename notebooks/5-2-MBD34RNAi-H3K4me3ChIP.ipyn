{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 5-2-MBD34-RNAi-H3K4me3ChIP\n",
    "Jakke Neiro$^1$\n",
    "1. Aboobaker laboratory, Department of Zoology, University of Oxford"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Contents of notebook"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "* 1. Introduction\n",
    "* 2. Data quality\n",
    "    * 2.1 Data download\n",
    "    * 2.2 FastQC\n",
    "        * 2.2.1 SRR4089722 (h3k4me3_gfp01)\n",
    "        * 2.2.2 SRR4089758 (h3k4me3_gfp02)\n",
    "        * 2.2.3 SRR4089767 (input_gfp01)\n",
    "        * 2.2.4 SRR4089768 (input_gfp02)\n",
    "        * 2.2.5 SRR4089769 (h3k4me3_gfp03)\n",
    "        * 2.2.6 SRR4089770 (input_gfp03)\n",
    "        * 2.2.7 SRR4089778 (h3k4me3_lpt01)\n",
    "        * 2.2.8 SRR4089799 (h3k4me3_lpt02)\n",
    "        * 2.2.9 SRR4089842 (h3k4me3_lpt03)\n",
    "* 3. Trimming\n",
    "    * 3.1 Trimmomatic\n",
    "* 4. Alignment\n",
    "* 5. Filtering\n",
    "    * 5.1 Sam to Bam\n",
    "    * 5.2 Unique reads and sorting\n",
    "    * 5.3 Removing duplicates\n",
    "* 6. Coverage tracks\n",
    "    * 6.1 ChIP-seq H3K4me3 track\n",
    "    * 6.2 ChIP-seq H3K4me3 WT vs. lpt(RNAi) track"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Files\n",
    "* Input: SRR4089842, SRR4089799, SRR4089778, SRR4089770, SRR4089769, SRR4089768, SRR4089767, SRR4089758, SRR4089722\n",
    "* Output: h3k4me3RNAilog2.bw"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 1. Introduction"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The H3K4me3 ChIP-seq data upon MBD3/4 RNAi was inspected, trimmed, and aligned to the planarian genome. Coverage files were generated."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 2. Data download and FastQC"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 2.1 Data download"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The files were donwloaded: "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "SRR4089842\n",
      "SRR4089799\n",
      "SRR4089778\n",
      "SRR4089770\n",
      "SRR4089769\n",
      "SRR4089768\n",
      "SRR4089767\n",
      "SRR4089758\n",
      "SRR4089722\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "less sample.list"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "#!/bin/bash\n",
      "\n",
      "while read p; do ~/software/sratoolkit/bin/fastq-dump -A $p --gzip --split-files; done < sample.list\n",
      "\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "less data_download_paired.sh"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 2.2 FastQC"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "FastQC was performed to inspect the quality of the files: "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "#!/bin/bash\n",
      "\n",
      "for f in *gz; do ~/software/FastQC/fastqc $f; done\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "less fastqc.sh"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 2.2.1 SRR4089722 (h3k4me3_gfp01)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PASS\tBasic Statistics\tSRR4089722_1.fastq.gz\n",
      "PASS\tPer base sequence quality\tSRR4089722_1.fastq.gz\n",
      "PASS\tPer sequence quality scores\tSRR4089722_1.fastq.gz\n",
      "FAIL\tPer base sequence content\tSRR4089722_1.fastq.gz\n",
      "FAIL\tPer sequence GC content\tSRR4089722_1.fastq.gz\n",
      "PASS\tPer base N content\tSRR4089722_1.fastq.gz\n",
      "WARN\tSequence Length Distribution\tSRR4089722_1.fastq.gz\n",
      "PASS\tSequence Duplication Levels\tSRR4089722_1.fastq.gz\n",
      "FAIL\tOverrepresented sequences\tSRR4089722_1.fastq.gz\n",
      "PASS\tAdapter Content\tSRR4089722_1.fastq.gz\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089722_1_fastqc\n",
    "less summary.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      ">>Overrepresented sequences\tfail\n",
      "#Sequence\tCount\tPercentage\tPossible Source\n",
      "GATCGGAAGAGCACACGTCTGAACTCCAGTCACTGACCA\t2131798\t8.79988857922161\tTruSeq Adapter, Index 4 (100% over 39bp)\n",
      ">>END_MODULE\n",
      ">>Adapter Content\tpass\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089722_1_fastqc\n",
    "grep -A 4 \"Overrepresented\" fastqc_data.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PASS\tBasic Statistics\tSRR4089722_2.fastq.gz\n",
      "PASS\tPer base sequence quality\tSRR4089722_2.fastq.gz\n",
      "PASS\tPer sequence quality scores\tSRR4089722_2.fastq.gz\n",
      "FAIL\tPer base sequence content\tSRR4089722_2.fastq.gz\n",
      "FAIL\tPer sequence GC content\tSRR4089722_2.fastq.gz\n",
      "PASS\tPer base N content\tSRR4089722_2.fastq.gz\n",
      "WARN\tSequence Length Distribution\tSRR4089722_2.fastq.gz\n",
      "PASS\tSequence Duplication Levels\tSRR4089722_2.fastq.gz\n",
      "FAIL\tOverrepresented sequences\tSRR4089722_2.fastq.gz\n",
      "PASS\tAdapter Content\tSRR4089722_2.fastq.gz\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089722_2_fastqc\n",
    "less summary.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      ">>Overrepresented sequences\tfail\n",
      "#Sequence\tCount\tPercentage\tPossible Source\n",
      "GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG\t2072246\t8.55406277177184\tNo Hit\n",
      ">>END_MODULE\n",
      ">>Adapter Content\tpass\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089722_2_fastqc\n",
    "grep -A 4 \"Overrepresented\" fastqc_data.txt"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 2.2.2 SRR4089758 (h3k4me3_gfp02)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PASS\tBasic Statistics\tSRR4089758_1.fastq.gz\n",
      "PASS\tPer base sequence quality\tSRR4089758_1.fastq.gz\n",
      "PASS\tPer sequence quality scores\tSRR4089758_1.fastq.gz\n",
      "FAIL\tPer base sequence content\tSRR4089758_1.fastq.gz\n",
      "FAIL\tPer sequence GC content\tSRR4089758_1.fastq.gz\n",
      "PASS\tPer base N content\tSRR4089758_1.fastq.gz\n",
      "WARN\tSequence Length Distribution\tSRR4089758_1.fastq.gz\n",
      "WARN\tSequence Duplication Levels\tSRR4089758_1.fastq.gz\n",
      "FAIL\tOverrepresented sequences\tSRR4089758_1.fastq.gz\n",
      "PASS\tAdapter Content\tSRR4089758_1.fastq.gz\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089758_1_fastqc\n",
    "less summary.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      ">>Overrepresented sequences\tfail\n",
      "#Sequence\tCount\tPercentage\tPossible Source\n",
      "GATCGGAAGAGCACACGTCTGAACTCCAGTCACCTTGTA\t5397762\t16.15192528037678\tTruSeq Adapter, Index 12 (100% over 39bp)\n",
      "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\t42757\t0.12794337157011926\tNo Hit\n",
      ">>END_MODULE\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd  SRR4089758_1_fastqc\n",
    "grep -A 4 \"Overrepresented\" fastqc_data.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PASS\tBasic Statistics\tSRR4089758_2.fastq.gz\n",
      "PASS\tPer base sequence quality\tSRR4089758_2.fastq.gz\n",
      "PASS\tPer sequence quality scores\tSRR4089758_2.fastq.gz\n",
      "FAIL\tPer base sequence content\tSRR4089758_2.fastq.gz\n",
      "FAIL\tPer sequence GC content\tSRR4089758_2.fastq.gz\n",
      "PASS\tPer base N content\tSRR4089758_2.fastq.gz\n",
      "WARN\tSequence Length Distribution\tSRR4089758_2.fastq.gz\n",
      "WARN\tSequence Duplication Levels\tSRR4089758_2.fastq.gz\n",
      "FAIL\tOverrepresented sequences\tSRR4089758_2.fastq.gz\n",
      "PASS\tAdapter Content\tSRR4089758_2.fastq.gz\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089758_2_fastqc\n",
    "less summary.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      ">>Overrepresented sequences\tfail\n",
      "#Sequence\tCount\tPercentage\tPossible Source\n",
      "GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG\t5268803\t15.766036437513367\tNo Hit\n",
      "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\t38454\t0.11506734360122006\tNo Hit\n",
      ">>END_MODULE\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd  SRR4089758_2_fastqc\n",
    "grep -A 4 \"Overrepresented\" fastqc_data.txt"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 2.2.3 SRR4089767 (input_gfp01)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PASS\tBasic Statistics\tSRR4089767_1.fastq.gz\n",
      "PASS\tPer base sequence quality\tSRR4089767_1.fastq.gz\n",
      "PASS\tPer sequence quality scores\tSRR4089767_1.fastq.gz\n",
      "FAIL\tPer base sequence content\tSRR4089767_1.fastq.gz\n",
      "PASS\tPer sequence GC content\tSRR4089767_1.fastq.gz\n",
      "PASS\tPer base N content\tSRR4089767_1.fastq.gz\n",
      "WARN\tSequence Length Distribution\tSRR4089767_1.fastq.gz\n",
      "PASS\tSequence Duplication Levels\tSRR4089767_1.fastq.gz\n",
      "FAIL\tOverrepresented sequences\tSRR4089767_1.fastq.gz\n",
      "PASS\tAdapter Content\tSRR4089767_1.fastq.gz\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089767_1_fastqc\n",
    "less summary.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      ">>Overrepresented sequences\tfail\n",
      "#Sequence\tCount\tPercentage\tPossible Source\n",
      "GATCGGAAGAGCACACGTCTGAACTCCAGTCACACTTGA\t1534234\t4.698910117127738\tTruSeq Adapter, Index 8 (100% over 39bp)\n",
      ">>END_MODULE\n",
      ">>Adapter Content\tpass\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089767_1_fastqc\n",
    "grep -A 4 \"Overrepresented\" fastqc_data.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PASS\tBasic Statistics\tSRR4089767_2.fastq.gz\n",
      "PASS\tPer base sequence quality\tSRR4089767_2.fastq.gz\n",
      "PASS\tPer sequence quality scores\tSRR4089767_2.fastq.gz\n",
      "FAIL\tPer base sequence content\tSRR4089767_2.fastq.gz\n",
      "FAIL\tPer sequence GC content\tSRR4089767_2.fastq.gz\n",
      "PASS\tPer base N content\tSRR4089767_2.fastq.gz\n",
      "WARN\tSequence Length Distribution\tSRR4089767_2.fastq.gz\n",
      "PASS\tSequence Duplication Levels\tSRR4089767_2.fastq.gz\n",
      "FAIL\tOverrepresented sequences\tSRR4089767_2.fastq.gz\n",
      "PASS\tAdapter Content\tSRR4089767_2.fastq.gz\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089767_2_fastqc\n",
    "less summary.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      ">>Overrepresented sequences\tfail\n",
      "#Sequence\tCount\tPercentage\tPossible Source\n",
      "GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG\t1490936\t4.566301003882043\tNo Hit\n",
      ">>END_MODULE\n",
      ">>Adapter Content\tpass\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089767_2_fastqc\n",
    "grep -A 4 \"Overrepresented\" fastqc_data.txt"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 2.2.4 SRR4089768 (input_gfp02)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PASS\tBasic Statistics\tSRR4089768_1.fastq.gz\n",
      "PASS\tPer base sequence quality\tSRR4089768_1.fastq.gz\n",
      "PASS\tPer sequence quality scores\tSRR4089768_1.fastq.gz\n",
      "FAIL\tPer base sequence content\tSRR4089768_1.fastq.gz\n",
      "PASS\tPer sequence GC content\tSRR4089768_1.fastq.gz\n",
      "PASS\tPer base N content\tSRR4089768_1.fastq.gz\n",
      "WARN\tSequence Length Distribution\tSRR4089768_1.fastq.gz\n",
      "PASS\tSequence Duplication Levels\tSRR4089768_1.fastq.gz\n",
      "FAIL\tOverrepresented sequences\tSRR4089768_1.fastq.gz\n",
      "PASS\tAdapter Content\tSRR4089768_1.fastq.gz\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089768_1_fastqc\n",
    "less summary.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      ">>Overrepresented sequences\tfail\n",
      "#Sequence\tCount\tPercentage\tPossible Source\n",
      "GATCGGAAGAGCACACGTCTGAACTCCAGTCACTGACCA\t918344\t3.4431290053092054\tTruSeq Adapter, Index 4 (100% over 39bp)\n",
      "CATCGGAAGAGCACACGTCTGAACTCCAGTCACTGACCA\t103628\t0.38853041187418047\tTruSeq Adapter, Index 4 (97% over 39bp)\n",
      ">>END_MODULE\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089768_1_fastqc\n",
    "grep -A 4 \"Overrepresented\" fastqc_data.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PASS\tBasic Statistics\tSRR4089768_2.fastq.gz\n",
      "PASS\tPer base sequence quality\tSRR4089768_2.fastq.gz\n",
      "PASS\tPer sequence quality scores\tSRR4089768_2.fastq.gz\n",
      "FAIL\tPer base sequence content\tSRR4089768_2.fastq.gz\n",
      "FAIL\tPer sequence GC content\tSRR4089768_2.fastq.gz\n",
      "PASS\tPer base N content\tSRR4089768_2.fastq.gz\n",
      "WARN\tSequence Length Distribution\tSRR4089768_2.fastq.gz\n",
      "PASS\tSequence Duplication Levels\tSRR4089768_2.fastq.gz\n",
      "FAIL\tOverrepresented sequences\tSRR4089768_2.fastq.gz\n",
      "PASS\tAdapter Content\tSRR4089768_2.fastq.gz\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089768_2_fastqc\n",
    "less summary.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      ">>Overrepresented sequences\tfail\n",
      "#Sequence\tCount\tPercentage\tPossible Source\n",
      "GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG\t834923\t3.130360299081584\tNo Hit\n",
      ">>END_MODULE\n",
      ">>Adapter Content\tpass\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089768_2_fastqc\n",
    "grep -A 4 \"Overrepresented\" fastqc_data.txt"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 2.2.5 SRR4089769 (h3k4me3_gfp03)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PASS\tBasic Statistics\tSRR4089769_1.fastq.gz\n",
      "PASS\tPer base sequence quality\tSRR4089769_1.fastq.gz\n",
      "PASS\tPer sequence quality scores\tSRR4089769_1.fastq.gz\n",
      "FAIL\tPer base sequence content\tSRR4089769_1.fastq.gz\n",
      "PASS\tPer sequence GC content\tSRR4089769_1.fastq.gz\n",
      "PASS\tPer base N content\tSRR4089769_1.fastq.gz\n",
      "WARN\tSequence Length Distribution\tSRR4089769_1.fastq.gz\n",
      "PASS\tSequence Duplication Levels\tSRR4089769_1.fastq.gz\n",
      "FAIL\tOverrepresented sequences\tSRR4089769_1.fastq.gz\n",
      "PASS\tAdapter Content\tSRR4089769_1.fastq.gz\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089769_1_fastqc\n",
    "less summary.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      ">>Overrepresented sequences\tfail\n",
      "#Sequence\tCount\tPercentage\tPossible Source\n",
      "GATCGGAAGAGCACACGTCTGAACTCCAGTCACACTTG\t2841821\t3.190171130457828\tTruSeq Adapter, Index 8 (100% over 38bp)\n",
      "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\t255470\t0.2867854867347596\tNo Hit\n",
      ">>END_MODULE\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089769_1_fastqc\n",
    "grep -A 4 \"Overrepresented\" fastqc_data.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PASS\tBasic Statistics\tSRR4089769_2.fastq.gz\n",
      "PASS\tPer base sequence quality\tSRR4089769_2.fastq.gz\n",
      "PASS\tPer sequence quality scores\tSRR4089769_2.fastq.gz\n",
      "FAIL\tPer base sequence content\tSRR4089769_2.fastq.gz\n",
      "WARN\tPer sequence GC content\tSRR4089769_2.fastq.gz\n",
      "PASS\tPer base N content\tSRR4089769_2.fastq.gz\n",
      "WARN\tSequence Length Distribution\tSRR4089769_2.fastq.gz\n",
      "PASS\tSequence Duplication Levels\tSRR4089769_2.fastq.gz\n",
      "FAIL\tOverrepresented sequences\tSRR4089769_2.fastq.gz\n",
      "PASS\tAdapter Content\tSRR4089769_2.fastq.gz\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089769_2_fastqc\n",
    "less summary.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      ">>Overrepresented sequences\tfail\n",
      "#Sequence\tCount\tPercentage\tPossible Source\n",
      "GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG\t834923\t3.130360299081584\tNo Hit\n",
      ">>END_MODULE\n",
      ">>Adapter Content\tpass\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089768_2_fastqc\n",
    "grep -A 4 \"Overrepresented\" fastqc_data.txt"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 2.2.6 SRR4089770 (input_gfp03)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PASS\tBasic Statistics\tSRR4089770_1.fastq.gz\n",
      "PASS\tPer base sequence quality\tSRR4089770_1.fastq.gz\n",
      "PASS\tPer sequence quality scores\tSRR4089770_1.fastq.gz\n",
      "FAIL\tPer base sequence content\tSRR4089770_1.fastq.gz\n",
      "PASS\tPer sequence GC content\tSRR4089770_1.fastq.gz\n",
      "PASS\tPer base N content\tSRR4089770_1.fastq.gz\n",
      "WARN\tSequence Length Distribution\tSRR4089770_1.fastq.gz\n",
      "PASS\tSequence Duplication Levels\tSRR4089770_1.fastq.gz\n",
      "WARN\tOverrepresented sequences\tSRR4089770_1.fastq.gz\n",
      "PASS\tAdapter Content\tSRR4089770_1.fastq.gz\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089770_1_fastqc\n",
    "less summary.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      ">>Overrepresented sequences\twarn\n",
      "#Sequence\tCount\tPercentage\tPossible Source\n",
      "GATCGGAAGAGCACACGTCTGAACTCCAGTCACCTTGT\t235070\t0.5036044232780288\tTruSeq Adapter, Index 12 (100% over 38bp)\n",
      "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\t99842\t0.21389744684104714\tNo Hit\n",
      ">>END_MODULE\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089770_1_fastqc\n",
    "grep -A 4 \"Overrepresented\" fastqc_data.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PASS\tBasic Statistics\tSRR4089770_2.fastq.gz\n",
      "PASS\tPer base sequence quality\tSRR4089770_2.fastq.gz\n",
      "PASS\tPer sequence quality scores\tSRR4089770_2.fastq.gz\n",
      "FAIL\tPer base sequence content\tSRR4089770_2.fastq.gz\n",
      "PASS\tPer sequence GC content\tSRR4089770_2.fastq.gz\n",
      "PASS\tPer base N content\tSRR4089770_2.fastq.gz\n",
      "WARN\tSequence Length Distribution\tSRR4089770_2.fastq.gz\n",
      "PASS\tSequence Duplication Levels\tSRR4089770_2.fastq.gz\n",
      "WARN\tOverrepresented sequences\tSRR4089770_2.fastq.gz\n",
      "PASS\tAdapter Content\tSRR4089770_2.fastq.gz\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089770_2_fastqc\n",
    "less summary.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      ">>Overrepresented sequences\twarn\n",
      "#Sequence\tCount\tPercentage\tPossible Source\n",
      "GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG\t121869\t0.2610871972623903\tNo Hit\n",
      "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\t105177\t0.22532693422007585\tNo Hit\n",
      ">>END_MODULE\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089770_2_fastqc\n",
    "grep -A 4 \"Overrepresented\" fastqc_data.txt"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 2.2.7 SRR4089778 (h3k4me3_lpt01)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PASS\tBasic Statistics\tSRR4089778_1.fastq.gz\n",
      "PASS\tPer base sequence quality\tSRR4089778_1.fastq.gz\n",
      "PASS\tPer sequence quality scores\tSRR4089778_1.fastq.gz\n",
      "FAIL\tPer base sequence content\tSRR4089778_1.fastq.gz\n",
      "FAIL\tPer sequence GC content\tSRR4089778_1.fastq.gz\n",
      "PASS\tPer base N content\tSRR4089778_1.fastq.gz\n",
      "WARN\tSequence Length Distribution\tSRR4089778_1.fastq.gz\n",
      "PASS\tSequence Duplication Levels\tSRR4089778_1.fastq.gz\n",
      "FAIL\tOverrepresented sequences\tSRR4089778_1.fastq.gz\n",
      "PASS\tAdapter Content\tSRR4089778_1.fastq.gz\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089778_1_fastqc\n",
    "less summary.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      ">>Overrepresented sequences\tfail\n",
      "#Sequence\tCount\tPercentage\tPossible Source\n",
      "GATCGGAAGAGCACACGTCTGAACTCCAGTCACTTAGGC\t3267572\t16.469942349667395\tTruSeq Adapter, Index 3 (100% over 39bp)\n",
      "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\t32264\t0.1626241808809932\tNo Hit\n",
      ">>END_MODULE\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089778_1_fastqc\n",
    "grep -A 4 \"Overrepresented\" fastqc_data.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PASS\tBasic Statistics\tSRR4089778_2.fastq.gz\n",
      "PASS\tPer base sequence quality\tSRR4089778_2.fastq.gz\n",
      "PASS\tPer sequence quality scores\tSRR4089778_2.fastq.gz\n",
      "FAIL\tPer base sequence content\tSRR4089778_2.fastq.gz\n",
      "FAIL\tPer sequence GC content\tSRR4089778_2.fastq.gz\n",
      "PASS\tPer base N content\tSRR4089778_2.fastq.gz\n",
      "WARN\tSequence Length Distribution\tSRR4089778_2.fastq.gz\n",
      "PASS\tSequence Duplication Levels\tSRR4089778_2.fastq.gz\n",
      "FAIL\tOverrepresented sequences\tSRR4089778_2.fastq.gz\n",
      "PASS\tAdapter Content\tSRR4089778_2.fastq.gz\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089778_2_fastqc\n",
    "less summary.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      ">>Overrepresented sequences\tfail\n",
      "#Sequence\tCount\tPercentage\tPossible Source\n",
      "GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG\t3154645\t15.900742595317407\tNo Hit\n",
      "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\t28521\t0.14375788070006223\tNo Hit\n",
      ">>END_MODULE\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089778_2_fastqc\n",
    "grep -A 4 \"Overrepresented\" fastqc_data.txt"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 2.2.8 SRR4089799 (h3k4me3_lpt02)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PASS\tBasic Statistics\tSRR4089799_1.fastq.gz\n",
      "PASS\tPer base sequence quality\tSRR4089799_1.fastq.gz\n",
      "PASS\tPer sequence quality scores\tSRR4089799_1.fastq.gz\n",
      "FAIL\tPer base sequence content\tSRR4089799_1.fastq.gz\n",
      "FAIL\tPer sequence GC content\tSRR4089799_1.fastq.gz\n",
      "PASS\tPer base N content\tSRR4089799_1.fastq.gz\n",
      "WARN\tSequence Length Distribution\tSRR4089799_1.fastq.gz\n",
      "WARN\tSequence Duplication Levels\tSRR4089799_1.fastq.gz\n",
      "FAIL\tOverrepresented sequences\tSRR4089799_1.fastq.gz\n",
      "PASS\tAdapter Content\tSRR4089799_1.fastq.gz\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089799_1_fastqc\n",
    "less summary.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      ">>Overrepresented sequences\tfail\n",
      "#Sequence\tCount\tPercentage\tPossible Source\n",
      "GATCGGAAGAGCACACGTCTGAACTCCAGTCACGGCTAC\t4558782\t16.10473901161985\tTruSeq Adapter, Index 11 (100% over 39bp)\n",
      "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\t36729\t0.1297519730396815\tNo Hit\n",
      ">>END_MODULE\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089799_1_fastqc\n",
    "grep -A 4 \"Overrepresented\" fastqc_data.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PASS\tBasic Statistics\tSRR4089799_2.fastq.gz\n",
      "PASS\tPer base sequence quality\tSRR4089799_2.fastq.gz\n",
      "PASS\tPer sequence quality scores\tSRR4089799_2.fastq.gz\n",
      "FAIL\tPer base sequence content\tSRR4089799_2.fastq.gz\n",
      "FAIL\tPer sequence GC content\tSRR4089799_2.fastq.gz\n",
      "PASS\tPer base N content\tSRR4089799_2.fastq.gz\n",
      "WARN\tSequence Length Distribution\tSRR4089799_2.fastq.gz\n",
      "WARN\tSequence Duplication Levels\tSRR4089799_2.fastq.gz\n",
      "FAIL\tOverrepresented sequences\tSRR4089799_2.fastq.gz\n",
      "PASS\tAdapter Content\tSRR4089799_2.fastq.gz\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089799_2_fastqc\n",
    "less summary.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      ">>Overrepresented sequences\tfail\n",
      "#Sequence\tCount\tPercentage\tPossible Source\n",
      "GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG\t4472322\t15.799303100241621\tNo Hit\n",
      "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\t30873\t0.10906457196368231\tNo Hit\n",
      ">>END_MODULE\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089799_2_fastqc\n",
    "grep -A 4 \"Overrepresented\" fastqc_data.txt"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 2.2.9 SRR4089842 (h3k4me3_lpt03)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PASS\tBasic Statistics\tSRR4089842_1.fastq.gz\n",
      "PASS\tPer base sequence quality\tSRR4089842_1.fastq.gz\n",
      "PASS\tPer sequence quality scores\tSRR4089842_1.fastq.gz\n",
      "FAIL\tPer base sequence content\tSRR4089842_1.fastq.gz\n",
      "PASS\tPer sequence GC content\tSRR4089842_1.fastq.gz\n",
      "PASS\tPer base N content\tSRR4089842_1.fastq.gz\n",
      "WARN\tSequence Length Distribution\tSRR4089842_1.fastq.gz\n",
      "WARN\tSequence Duplication Levels\tSRR4089842_1.fastq.gz\n",
      "FAIL\tOverrepresented sequences\tSRR4089842_1.fastq.gz\n",
      "PASS\tAdapter Content\tSRR4089842_1.fastq.gz\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089842_1_fastqc\n",
    "less summary.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      ">>Overrepresented sequences\tfail\n",
      "#Sequence\tCount\tPercentage\tPossible Source\n",
      "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\t1954728\t2.071826691567094\tNo Hit\n",
      ">>END_MODULE\n",
      ">>Adapter Content\tpass\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089842_1_fastqc\n",
    "grep -A 4 \"Overrepresented\" fastqc_data.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PASS\tBasic Statistics\tSRR4089842_2.fastq.gz\n",
      "PASS\tPer base sequence quality\tSRR4089842_2.fastq.gz\n",
      "PASS\tPer sequence quality scores\tSRR4089842_2.fastq.gz\n",
      "FAIL\tPer base sequence content\tSRR4089842_2.fastq.gz\n",
      "WARN\tPer sequence GC content\tSRR4089842_2.fastq.gz\n",
      "PASS\tPer base N content\tSRR4089842_2.fastq.gz\n",
      "WARN\tSequence Length Distribution\tSRR4089842_2.fastq.gz\n",
      "PASS\tSequence Duplication Levels\tSRR4089842_2.fastq.gz\n",
      "WARN\tOverrepresented sequences\tSRR4089842_2.fastq.gz\n",
      "PASS\tAdapter Content\tSRR4089842_2.fastq.gz\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "cd SRR4089842_2_fastqc\n",
    "less summary.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      ">>Overrepresented sequences\twarn\n",
      "#Sequence\tCount\tPercentage\tPossible Source\n",
      "GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG\t773990\t0.82035615236801\tNo Hit\n",
      "NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\t308164\t0.32662467646653753\tNo Hit\n",
      ">>END_MODULE\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd ~/../../../../data/ngs/smed/facs_rnaseq_datasets/sexual/chip_sexual_organised/k4me3\n",
    "cd SRR4089842_2_fastqc\n",
    "grep -A 4 \"Overrepresented\" fastqc_data.txt"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 3. Trimming"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 3.1 Trimmomatic"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "* SRR4089722_1: TruSeq4 GATCGGAAGAGCACACGTCTGAACTCCAGTCACTGACCA\n",
    "* SRR4089722_2: GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG\n",
    "* SRR4089758_1: TruSeq12 GATCGGAAGAGCACACGTCTGAACTCCAGTCACCTTGTA\n",
    "* SRR4089758_2: GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG\n",
    "* SRR4089767_1: TruSeq8 GATCGGAAGAGCACACGTCTGAACTCCAGTCACACTTGA\n",
    "* SRR4089767_1: GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG\n",
    "* SRR4089768_1: TruSeq4 GATCGGAAGAGCACACGTCTGAACTCCAGTCACTGACCA\n",
    "* SRR4089768_2: GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG\n",
    "* SRR4089769_1: TruSeq8 GATCGGAAGAGCACACGTCTGAACTCCAGTCACACTTG\n",
    "* SRR4089769_2: GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG\n",
    "* SRR4089770_1: TruSeq12 GATCGGAAGAGCACACGTCTGAACTCCAGTCACCTTGT\n",
    "* SRR4089770_2: GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG\n",
    "* SRR4089778_1: TruSeq3 GATCGGAAGAGCACACGTCTGAACTCCAGTCACTTAGGC\n",
    "* SRR4089778_2: GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG\n",
    "* SRR4089799_1: TruSeq11 GATCGGAAGAGCACACGTCTGAACTCCAGTCACGGCTAC\n",
    "* SRR4089799_2: GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "#!/bin/bash\n",
      "\n",
      "java -jar ~/software/Trimmomatic-0.39/trimmomatic-0.39.jar PE SRR4089722_1.fastq.gz SRR4089722_2.fastq.gz SRR4089722_1.trimmed.fastq.gz SRR4089722_1.untrimmed.fastq.gz SRR4089722_2.trimmed.fastq.gz SRR4089722_2.untrimmed.fastq.gz ILLUMINACLIP:TrueSeq4-1.fa:2:30:10\n",
      "\n",
      "java -jar ~/software/Trimmomatic-0.39/trimmomatic-0.39.jar PE SRR4089758_1.fastq.gz SRR4089758_2.fastq.gz SRR4089758_1.trimmed.fastq.gz SRR4089758_1.untrimmed.fastq.gz SRR4089758_2.trimmed.fastq.gz SRR4089758_2.untrimmed.fastq.gz ILLUMINACLIP:TrueSeq12-1.fa:2:30:10\n",
      "\n",
      "java -jar ~/software/Trimmomatic-0.39/trimmomatic-0.39.jar PE SRR4089767_1.fastq.gz SRR4089767_2.fastq.gz SRR4089767_1.trimmed.fastq.gz SRR4089767_1.untrimmed.fastq.gz SRR4089767_2.trimmed.fastq.gz SRR4089767_2.untrimmed.fastq.gz ILLUMINACLIP:TrueSeq8-1.fa:2:30:10\n",
      "\n",
      "java -jar ~/software/Trimmomatic-0.39/trimmomatic-0.39.jar PE SRR4089768_1.fastq.gz SRR4089768_2.fastq.gz SRR4089768_1.trimmed.fastq.gz SRR4089768_1.untrimmed.fastq.gz SRR4089768_2.trimmed.fastq.gz SRR4089768_2.untrimmed.fastq.gz ILLUMINACLIP:TrueSeq4-2.fa:2:30:10\n",
      "\n",
      "java -jar ~/software/Trimmomatic-0.39/trimmomatic-0.39.jar PE SRR4089769_1.fastq.gz SRR4089769_2.fastq.gz SRR4089769_1.trimmed.fastq.gz SRR4089769_1.untrimmed.fastq.gz SRR4089769_2.trimmed.fastq.gz SRR4089769_2.untrimmed.fastq.gz ILLUMINACLIP:TrueSeq8-2.fa:2:30:10\n",
      "\n",
      "java -jar ~/software/Trimmomatic-0.39/trimmomatic-0.39.jar PE SRR4089770_1.fastq.gz SRR4089770_2.fastq.gz SRR4089770_1.trimmed.fastq.gz SRR4089770_1.untrimmed.fastq.gz SRR4089770_2.trimmed.fastq.gz SRR4089770_2.untrimmed.fastq.gz ILLUMINACLIP:TrueSeq12-2.fa:2:30:10\n",
      "\n",
      "java -jar ~/software/Trimmomatic-0.39/trimmomatic-0.39.jar PE SRR4089778_1.fastq.gz SRR4089778_2.fastq.gz SRR4089778_1.trimmed.fastq.gz SRR4089778_1.untrimmed.fastq.gz SRR4089778_2.trimmed.fastq.gz SRR4089778_2.untrimmed.fastq.gz ILLUMINACLIP:TrueSeq3-1.fa:2:30:10\n",
      "\n",
      "java -jar ~/software/Trimmomatic-0.39/trimmomatic-0.39.jar PE SRR4089799_1.fastq.gz SRR4089799_2.fastq.gz SRR4089799_1.trimmed.fastq.gz SRR4089799_1.untrimmed.fastq.gz SRR4089799_2.trimmed.fastq.gz SRR4089799_2.untrimmed.fastq.gz ILLUMINACLIP:TrueSeq11-1.fa:2:30:10\n",
      "\n",
      "java -jar ~/software/Trimmomatic-0.39/trimmomatic-0.39.jar PE SRR4089842_1.fastq.gz SRR4089842_2.fastq.gz SRR4089842_1.trimmed.fastq.gz SRR4089842_1.untrimmed.fastq.gz SRR4089842_2.trimmed.fastq.gz SRR4089842_2.untrimmed.fastq.gz ILLUMINACLIP:TrueSeqG.fa:2:30:10\n",
      "\n",
      "\n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "less trimmomatic_paired.sh"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "#!/bin/bash\n",
      "\n",
      "for f in *trimmed.fastqc.gz; do ~/software/FastQC/fastqc $f; done\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "less fastqc_trimmed.sh"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 4. Alignment"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "#!/bin/bash\n",
      "\n",
      "~/software/bowtie2-2.4.1/bowtie2 -x ../../chip_RNAi/Smed_bowtie2-2.4.1 -1 SRR4089722_1.trimmed.fastq.gz -2 SRR4089722_2.trimmed.fastq.gz -p 12 -S SRR4089722.sam\n",
      "\n",
      "~/software/bowtie2-2.4.1/bowtie2 -x ../../chip_RNAi/Smed_bowtie2-2.4.1 -1 SRR4089758_1.trimmed.fastq.gz -2 SRR4089758_2.trimmed.fastq.gz -p 12 -S SRR4089758.sam\n",
      "\n",
      "~/software/bowtie2-2.4.1/bowtie2 -x ../../chip_RNAi/Smed_bowtie2-2.4.1 -1 SRR4089767_1.trimmed.fastq.gz -2 SRR4089767_2.trimmed.fastq.gz -p 12 -S SRR4089767.sam\n",
      "\n",
      "~/software/bowtie2-2.4.1/bowtie2 -x ../../chip_RNAi/Smed_bowtie2-2.4.1 -1 SRR4089768_1.trimmed.fastq.gz -2 SRR4089768_2.trimmed.fastq.gz -p 12 -S SRR4089768.sam\n",
      "\n",
      "~/software/bowtie2-2.4.1/bowtie2 -x ../../chip_RNAi/Smed_bowtie2-2.4.1 -1 SRR4089769_1.trimmed.fastq.gz -2 SRR4089769_2.trimmed.fastq.gz -p 12 -S SRR4089769.sam\n",
      "\n",
      "~/software/bowtie2-2.4.1/bowtie2 -x ../../chip_RNAi/Smed_bowtie2-2.4.1 -1 SRR4089770_1.trimmed.fastq.gz -2 SRR4089770_2.trimmed.fastq.gz -p 12 -S SRR4089770.sam\n",
      "\n",
      "~/software/bowtie2-2.4.1/bowtie2 -x ../../chip_RNAi/Smed_bowtie2-2.4.1 -1 SRR4089778_1.trimmed.fastq.gz -2 SRR4089778_2.trimmed.fastq.gz -p 12 -S SRR4089778.sam\n",
      "\n",
      "~/software/bowtie2-2.4.1/bowtie2 -x ../../chip_RNAi/Smed_bowtie2-2.4.1 -1 SRR4089799_1.trimmed.fastq.gz -2 SRR4089799_2.trimmed.fastq.gz -p 12 -S SRR4089799.sam\n",
      "\n",
      "~/software/bowtie2-2.4.1/bowtie2 -x ../../chip_RNAi/Smed_bowtie2-2.4.1 -1 SRR4089842_1.trimmed.fastq.gz -2 SRR4089842_2.trimmed.fastq.gz -p 12 -S SRR4089842.sam\n",
      "\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "less align_paired.sh"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 5. Filtering"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 5.1 Sam to bam"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The sam files were coverted to bam files: "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "#!/bin/bash\n",
      "\n",
      "samtools view -b -S SRR4089722.sam > SRR4089722.bam \n",
      "\n",
      "samtools view -b -S SRR4089758.sam > SRR4089758.bam\n",
      "\n",
      "samtools view -b -S SRR4089767.sam > SRR4089767.bam\n",
      "\n",
      "samtools view -b -S SRR4089768.sam > SRR4089768.bam\n",
      "\n",
      "samtools view -b -S SRR4089769.sam > SRR4089769.bam\n",
      " \n",
      "samtools view -b -S SRR4089770.sam > SRR4089770.bam\n",
      "\n",
      "samtools view -b -S SRR4089778.sam > SRR4089778.bam\n",
      "\n",
      "samtools view -b -S SRR4089799.sam > SRR4089799.bam\n",
      "\n",
      "samtools view -b -S SRR4089842.sam > SRR4089842.bam\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "less sam2bam.sh"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 5.2 Unique reads and sorting"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "#!/bin/bash\n",
      "\n",
      "samtools view -q 10 -b SRR4089722.bam > SRR4089722.uniq.bam \n",
      "samtools view -q 10 -b SRR4089758.bam > SRR4089758.uniq.bam\n",
      "samtools view -q 10 -b SRR4089767.bam > SRR4089767.uniq.bam\n",
      "samtools view -q 10 -b SRR4089768.bam > SRR4089768.uniq.bam\n",
      "samtools view -q 10 -b SRR4089769.bam > SRR4089769.uniq.bam\n",
      "samtools view -q 10 -b SRR4089770.bam > SRR4089770.uniq.bam\n",
      "samtools view -q 10 -b SRR4089778.bam > SRR4089778.uniq.bam\n",
      "samtools view -q 10 -b SRR4089799.bam > SRR4089799.uniq.bam\n",
      "samtools view -q 10 -b SRR4089842.bam > SRR4089842.uniq.bam\n",
      "\n",
      "\n",
      "samtools sort SRR4089722.uniq.bam -o SRR4089722.sorted.bam \n",
      "samtools sort SRR4089758.uniq.bam -o SRR4089758.sorted.bam\n",
      "samtools sort SRR4089767.uniq.bam -o SRR4089767.sorted.bam \n",
      "samtools sort SRR4089768.uniq.bam -o SRR4089768.sorted.bam \n",
      "samtools sort SRR4089769.uniq.bam -o SRR4089769.sorted.bam \n",
      "samtools sort SRR4089770.uniq.bam -o SRR4089770.sorted.bam\n",
      "samtools sort SRR4089778.uniq.bam -o SRR4089778.sorted.bam \n",
      "samtools sort SRR4089799.uniq.bam -o SRR4089799.sorted.bam \n",
      "samtools sort SRR4089842.uniq.bam -o SRR4089842.sorted.bam  \n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "less samq.sh"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 5.3 Removing duplicates"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "#!/bin/bash\n",
      "\n",
      "samtools rmdup SRR4089722.sorted.bam SRR4089722.sorted.rmdup.bam\n",
      "samtools rmdup SRR4089758.sorted.bam SRR4089758.sorted.rmdup.bam\n",
      "samtools rmdup SRR4089767.sorted.bam SRR4089767.sorted.rmdup.bam\n",
      "samtools rmdup SRR4089768.sorted.bam SRR4089768.sorted.rmdup.bam\n",
      "samtools rmdup SRR4089769.sorted.bam SRR4089769.sorted.rmdup.bam\n",
      "samtools rmdup SRR4089770.sorted.bam SRR4089770.sorted.rmdup.bam\n",
      "samtools rmdup SRR4089778.sorted.bam SRR4089778.sorted.rmdup.bam\n",
      "samtools rmdup SRR4089799.sorted.bam SRR4089799.sorted.rmdup.bam\n",
      "samtools rmdup SRR4089842.sorted.bam SRR4089842.sorted.rmdup.bam\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "less rmdup.sh"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 6. Coverage"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 6.1 ChIP-seq H3K4me3 track"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Index files were generated for bam files: "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "#!/bin/bash\n",
      "\n",
      "samtools index -b SRR4089722.sorted.rmdup.bam\n",
      "samtools index -b SRR4089758.sorted.rmdup.bam\n",
      "samtools index -b SRR4089767.sorted.rmdup.bam\n",
      "samtools index -b SRR4089768.sorted.rmdup.bam\n",
      "samtools index -b SRR4089769.sorted.rmdup.bam\n",
      "samtools index -b SRR4089770.sorted.rmdup.bam\n",
      "samtools index -b SRR4089778.sorted.rmdup.bam\n",
      "samtools index -b SRR4089799.sorted.rmdup.bam\n",
      "samtools index -b SRR4089842.sorted.rmdup.bam\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "less bamindex.sh"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#%%bash\n",
    "#cd /hydra/chip_sexual_organised/k4me3\n",
    "#nohup ./bamindex.sh &"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "-rw-r--r-- 1 ubuntu ubuntu 668232 Apr 23  2020 SRR4089722.sorted.rmdup.bam.bai\n",
      "-rw-r--r-- 1 ubuntu ubuntu 695528 Apr 23  2020 SRR4089758.sorted.rmdup.bam.bai\n",
      "-rw-r--r-- 1 ubuntu ubuntu 643808 Apr 23  2020 SRR4089767.sorted.rmdup.bam.bai\n",
      "-rw-r--r-- 1 ubuntu ubuntu 636944 Apr 23  2020 SRR4089768.sorted.rmdup.bam.bai\n",
      "-rw-r--r-- 1 ubuntu ubuntu 886048 Apr 23  2020 SRR4089769.sorted.rmdup.bam.bai\n",
      "-rw-r--r-- 1 ubuntu ubuntu 661400 Apr 23  2020 SRR4089770.sorted.rmdup.bam.bai\n",
      "-rw-r--r-- 1 ubuntu ubuntu 686304 Apr 23  2020 SRR4089778.sorted.rmdup.bam.bai\n",
      "-rw-r--r-- 1 ubuntu ubuntu 688392 Apr 23  2020 SRR4089799.sorted.rmdup.bam.bai\n",
      "-rw-r--r-- 1 ubuntu ubuntu 936616 Apr 23  2020 SRR4089842.sorted.rmdup.bam.bai\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "ls -l *bai"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "* h3k4me3_gfp01 SRR4089722 and input_gfp01 SRR4089767\n",
    "* h3k4me3_gfp02 SRR4089758 and input_gfp02 SRR4089768\n",
    "* h3k4me3_gfp03 SRR4089769 and input_gfp03 SRR4089770\n",
    "* h3k4me3_lpt01 SRR4089778 and input_lpt01 SRR4089771\n",
    "* h3k4me3_lpt02 SRR4089799 and input_lpt02 SRR4089772\n",
    "* h3k4me3_lpt03 SRR4089842 and input_lpt03 SRR4089773"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The mean of RNAi knockdown samples was calculated:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "#!/bin/bash\n",
      "\n",
      "bamCompare -b1 SRR4089722.sorted.rmdup.bam -b2 SRR4089767.sorted.rmdup.bam -o h3k4me3_1.bdg -of bedgraph --scaleFactorsMethod SES --smoothLength 50 -bs 10\n",
      "bamCompare -b1 SRR4089722.sorted.rmdup.bam -b2 SRR4089767.sorted.rmdup.bam -o h3k4me3_1.bw -of bigwig --scaleFactorsMethod SES --smoothLength 50 -bs 10\n",
      "\n",
      "bamCompare -b1 SRR4089758.sorted.rmdup.bam -b2 SRR4089768.sorted.rmdup.bam -o h3k4me3_2.bdg -of bedgraph --scaleFactorsMethod SES --smoothLength 50 -bs 10\n",
      "bamCompare -b1 SRR4089758.sorted.rmdup.bam -b2 SRR4089768.sorted.rmdup.bam -o h3k4me3_2.bw -of bigwig --scaleFactorsMethod SES --smoothLength 50 -bs 10\n",
      "\n",
      "bamCompare -b1 SRR4089769.sorted.rmdup.bam -b2 SRR4089770.sorted.rmdup.bam -o h3k4me3_3.bdg -of bedgraph --scaleFactorsMethod SES --smoothLength 50 -bs 10\n",
      "bamCompare -b1 SRR4089769.sorted.rmdup.bam -b2 SRR4089770.sorted.rmdup.bam -o h3k4me3_3.bw -of bigwig --scaleFactorsMethod SES --smoothLength 50 -bs 10\n",
      "\n",
      "bamCompare -b1 SRR4089778.sorted.rmdup.bam -b2 ../../chip_RNAi/SRR4089771.sorted.rmdup.bam -o h3k4me3_lpt1.bdg -of bedgraph --scaleFactorsMethod SES --smoothLength 50 -bs 10\n",
      "bamCompare -b1 SRR4089778.sorted.rmdup.bam -b2 ../../chip_RNAi/SRR4089771.sorted.rmdup.bam -o h3k4me3_lpt1.bw -of bigwig --scaleFactorsMethod SES --smoothLength 50 -bs 10\n",
      "\n",
      "bamCompare -b1 SRR4089799.sorted.rmdup.bam -b2 ../../chip_RNAi/SRR4089772.sorted.rmdup.bam -o h3k4me3_lpt2.bdg -of bedgraph --scaleFactorsMethod SES --smoothLength 50 -bs 10\n",
      "bamCompare -b1 SRR4089799.sorted.rmdup.bam -b2 ../../chip_RNAi/SRR4089772.sorted.rmdup.bam -o h3k4me3_lpt2.bw -of bigwig --scaleFactorsMethod SES --smoothLength 50 -bs 10\n",
      "\n",
      "bamCompare -b1 SRR4089842.sorted.rmdup.bam -b2 ../../chip_RNAi/SRR4089773.sorted.rmdup.bam -o h3k4me3_lpt3.bdg -of bedgraph --scaleFactorsMethod SES --smoothLength 50 -bs 10\n",
      "bamCompare -b1 SRR4089842.sorted.rmdup.bam -b2 ../../chip_RNAi/SRR4089773.sorted.rmdup.bam -o h3k4me3_lpt3.bw -of bigwig --scaleFactorsMethod SES --smoothLength 50 -bs 10\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "less bamCov.sh"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [],
   "source": [
    "#%%bash\n",
    "#cd /hydra/chip_sexual_organised/k4me3\n",
    "#wiggletools mean h3k4me3_1.bw h3k4me3_2.bw h3k4me3_3.bw > h3k4me3_mean.wig\n",
    "#wiggletools mean h3k4me3_lpt1.bw h3k4me3_lpt2.bw h3k4me3_lpt3.bw > h3k4me3_mean_lpt.wig\n",
    "#wigToBigWig h3k4me3_mean.wig /hydra/sexual_genome_annotation_files/sexual_genome_annotation/sizes.genome h3k4me3_mean.bw\n",
    "#wigToBigWig h3k4me3_mean_lpt.wig /hydra/sexual_genome_annotation_files/sexual_genome_annotation/sizes.genome h3k4me3_mean_lpt.bw"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 6.2 ChIP-seq H3K4me3 WT vs. lpt(RNAi) track"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "#!/bin/bash\n",
      "\n",
      "bigwigCompare -b1 h3k4me3_mean_lpt.bw -b2 h3k4me3_mean.bw -o h3k4me3RNAilog2.bw -of bigwig\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "less h3k4me3RNAilog2.sh"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "h3k4me3RNAilog2.bw\n"
     ]
    }
   ],
   "source": [
    "%%bash\n",
    "cd /hydra/chip_sexual_organised/k4me3\n",
    "ls h3k4me3RNAilog2.bw"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# FINNISHED"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
